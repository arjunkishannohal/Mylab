# Tool 29 — HAR analysis (Agent 2) — STRICT RUN-CARD
# Goal: analyze your captured browser/mobile traffic (HAR) and extract high-value testing data.
# This is INFO GATHERING / ENRICHMENT (safe): it only parses files you captured.
# Inputs (contract):
#   - manual/har/*.har                          (your in-scope captures)
#   - outputs/activesubdomain.txt               (scope allowlist)
# Outputs (contract):
#   - outputs/har/important_data.txt            (single consolidated extraction)
#   - outputs/har/har-report.md                 (summary + what to test first)
#   - outputs/har/har_summary.json              (machine-readable summary)
#   - outputs/har/per_har/*                     (per-HAR copies so multiple accounts/roles don’t overwrite each other)
# Time rule: keep each command under ~9 minutes.

# ----------------------------
# 1) Preconditions
# ----------------------------
# Place your HAR file(s) in:
#   manual\har\
# Example:
#   manual\har\user.har
#   manual\har\admin.har
#
# If the folders don’t exist:
#   New-Item -ItemType Directory -Force manual\har | Out-Null
#
# Allowlist must exist:
#   if (!(Test-Path outputs\activesubdomain.txt)) { throw "Missing outputs\\activesubdomain.txt" }

# ----------------------------
# 2) Tool
# ----------------------------
# Analyzer script:
#   task\task29\har_analyzer.py
# Reference/spec:
#   task\task29\task0-har-analysis.txt
#
# It enforces scope via outputs\activesubdomain.txt and redacts sensitive values in reports.

# ----------------------------
# 3) Run (PowerShell)
# ----------------------------
# Single HAR:
#   python task\task29\har_analyzer.py --har manual\har\sample.har --workspace .
#
# Multiple HARs (one by one, deterministic):
#   Get-ChildItem manual\har -Filter '*.har' | Sort-Object Name | ForEach-Object {
#     Write-Host "[har] analyzing $($_.FullName)"
#     python task\task29\har_analyzer.py --har $_.FullName --workspace .
#   }

# ----------------------------
# 4) Output sanity check
# ----------------------------
#   if (!(Test-Path outputs\har\important_data.txt)) { throw "Missing outputs\\har\\important_data.txt" }
#   if (!(Test-Path outputs\har\har-report.md)) { throw "Missing outputs\\har\\har-report.md" }
#   if (!(Test-Path outputs\har\har_summary.json)) { throw "Missing outputs\\har\\har_summary.json" }
#
# Per-HAR outputs (written automatically, one set per input HAR):
#   if (!(Test-Path outputs\har\per_har)) { throw "Missing outputs\\har\\per_har" }

# ----------------------------
# 5) Notes
# ----------------------------
# - This step helps you decide what to test next (auth flows, admin endpoints, upload endpoints, API patterns, etc.).
# - Do NOT paste raw tokens into issues/reports; keep redacted previews only.
